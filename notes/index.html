<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <!-- è®¾ç½®å­—ç¬¦é›†ä¸º UTF-8 -->

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- å“åº”å¼å¸ƒå±€ï¼Œé€‚é…ç§»åŠ¨è®¾å¤‡ -->

  <!-- é¡µé¢æ ‡é¢˜ -->
  <!-- å¦‚æœå½“å‰é¡µé¢æœ‰æ ‡é¢˜ï¼Œåˆ™æ˜¾ç¤º "é¡µé¢æ ‡é¢˜ | ç½‘ç«™æ ‡é¢˜" -->
  <!-- å¦åˆ™åªæ˜¾ç¤ºç½‘ç«™æ ‡é¢˜ config.title -->
  <title>
    ğŸ“’ åœ¨çº¿ç¬”è®° | Sun Blog
  </title>

  <!-- é¡µé¢æè¿°ï¼Œç”¨äº SEO -->
  <meta name="description" content="ä¸€ä¸ªè®°å½•å¼€å‘ã€å­¦ä¹ ä¸ç”Ÿæ´»ç‚¹æ»´çš„åšå®¢">

  <!-- ===== å…¨å±€æ ·å¼å¼•å…¥ ===== -->
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/sidebar.css">
  <link rel="stylesheet" href="/css/post-list.css">
  <link rel="stylesheet" href="/css/page.css">
  <link rel="stylesheet" href="/css/category.css">
  <link rel="stylesheet" href="/css/archive.css">
  <link rel="stylesheet" href="/css/layout.css">
  <!-- å„æ¨¡å—æ ·å¼ï¼Œä¾¿äºç»´æŠ¤ -->

  <!-- ===== å­—ä½“ä¸å›¾æ ‡ ===== -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
  <!-- ç½‘ç«™ favicon å’Œ Google å­—ä½“ -->

  <!-- ===== ç™»å½•çŠ¶æ€æ£€æŸ¥ ===== -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const onLoginPage = window.location.pathname.startsWith("/login");
      if (!onLoginPage && !localStorage.getItem("isLoggedIn")) {
        window.location.href = "/login/";
      }
      // å¦‚æœæœªç™»å½•ä¸”ä¸åœ¨ç™»å½•é¡µï¼Œè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
    });
  </script>
<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  
    <!-- ===== é¡¶éƒ¨å¯¼èˆªæ  ===== -->
    <header class="top-nav">
  <!-- ============================
       é¡¶éƒ¨å¯¼èˆªæ æ¨¡å—
       åŠŸèƒ½ï¼š
         - æ˜¾ç¤ºç½‘ç«™ logo
         - æä¾›ä¸»èœå•å¯¼èˆª
         - æŠ€æœ¯åˆ†ç±»ä¸‹æ‹‰èœå•
         - æ–°å»ºç¬”è®° / å…³äºæˆ‘ / æˆ‘çš„é¡¹ç›® / æŠ€èƒ½æ ‘
         - å°å±å¹•æ±‰å ¡èœå•åˆ‡æ¢
         - é€€å‡ºç™»å½•æŒ‰é’®
  ============================ -->

  <!-- ç½‘ç«™ Logo -->
  <div class="logo">
    <a href="/">é¦–é¡µ</a>
    <!-- ç‚¹å‡»è·³è½¬åˆ°ç½‘ç«™é¦–é¡µ -->
  </div>

  <!-- æ±‰å ¡æŒ‰é’®ï¼ˆå°å±å¹•æ—¶æ˜¾ç¤ºï¼‰ -->
  <button class="menu-toggle" onclick="toggleMenu()" aria-label="åˆ‡æ¢èœå•">â˜°</button>
  <!-- onclick è°ƒç”¨ toggleMenu() åˆ‡æ¢ç§»åŠ¨ç«¯èœå•æ˜¾ç¤ºçŠ¶æ€ -->

  <!-- ä¸»èœå•å®¹å™¨ -->
  <nav class="menu">

    <!-- æ™®é€šèœå•é¡¹ -->
    <a href="/new-note/">æ–°å»ºç¬”è®°</a>
    <a href="/notes/">ç¬”è®°åˆ—è¡¨</a>
    <a href="/archives/">æ—¶é—´è½´</a>
    <a href="/about/">å…³äºæˆ‘</a>
    <a href="/projects/">é¡¹ç›®é›†</a>
    <a href="/skills/">æŠ€èƒ½æ ‘</a>
    <!-- ç‚¹å‡»è·³è½¬åˆ°å¯¹åº”é¡µé¢ -->

    <!-- æŠ€æœ¯åˆ†ç±»ä¸‹æ‹‰èœå• -->
    <div class="dropdown">
      <button class="menu-btn" type="button">æŠ€æœ¯åˆ†ç±»</button>
      <!-- ä¸‹æ‹‰æŒ‰é’®ï¼Œç‚¹å‡»æ˜¾ç¤ºåˆ†ç±»åˆ—è¡¨ -->

      <div class="dropdown-content">
        

        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Java/">Java</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Java')">Java</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/SpringBoot/">SpringBoot</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('SpringBoot')">SpringBoot</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/JUnit/">JUnit</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('JUnit')">JUnit</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Maven/">Maven</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Maven')">Maven</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Mybatis/">Mybatis</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Mybatis')">Mybatis</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Git/">Git</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Git')">Git</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/SQL/">SQL</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('SQL')">SQL</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/VBA/">VBA</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('VBA')">VBA</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Azure/">Azure</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Azure')">Azure</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/Docker/">Docker</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('Docker')">Docker</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/%E5%89%8D%E7%AB%AF/">å‰ç«¯</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('å‰ç«¯')">å‰ç«¯</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/">æ¶æ„åˆ†æ</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('æ¶æ„åˆ†æ')">æ¶æ„åˆ†æ</a> -->
          
        
          <!-- éå†æŠ€æœ¯åˆ†ç±»æ•°ç»„ï¼Œç”Ÿæˆèœå•é¡¹ -->
          <!-- è·³è½¬åˆ° /categories/åˆ†ç±»å/ é¡µé¢ -->
          <a href="/categories/%E5%BF%AB%E6%8D%B7%E9%94%AE/">å¿«æ·é”®</a>

          <!-- å¦‚æœå¸Œæœ›ç‚¹å‡»åŠ¨æ€æ›´æ–°ä¾§è¾¹æ è€Œä¸æ˜¯è·³è½¬ï¼Œå¯æ”¹ä¸ºï¼š
          <a href="javascript:void(0)" onclick="selectMenu('å¿«æ·é”®')">å¿«æ·é”®</a> -->
          
        
      </div>
    </div>
    <!-- æŠ€æœ¯åˆ†ç±»ä¸‹æ‹‰èœå•ç»“æŸ -->

    <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
    <button class="logout" onclick="logout()">é€€å‡º</button>
    <!-- ç‚¹å‡»è°ƒç”¨ logout() æ¸…é™¤ç™»å½•çŠ¶æ€å¹¶è·³è½¬ç™»å½•é¡µ -->

  </nav>
  <!-- ä¸»èœå•å®¹å™¨ç»“æŸ -->

</header>
<!-- é¡¶éƒ¨å¯¼èˆªæ ç»“æŸ -->

    <!-- å¯¼å…¥ header éƒ¨åˆ†æ¨¡æ¿ -->

    <!-- ===== ä¾§è¾¹æ  ===== -->
    <aside class="sidebar" id="sidebar">
  <!-- ============================
       ä¾§è¾¹æ æ¨¡å—
       åŠŸèƒ½ï¼š
         - è‡ªåŠ¨è¯»å– Hexo åˆ†ç±»æ•°æ®
         - è‡ªåŠ¨è¯»å– Hexo æ ‡ç­¾æ•°æ®
         - æ¸²æŸ“ä¸ºåˆ†ç±»å¯¼èˆªå’Œæ ‡ç­¾äº‘
  ============================ -->

  <!-- åˆ†ç±»å¯¼èˆª -->
  <h3 class="sidebar-title">ğŸ“˜ åˆ†ç±»å¯¼èˆª</h3>
  <ul class="category-list">
    
      
        <li>
          <a href="/categories/JUnit/">
            JUnit (1)
          </a>
        </li>
      
        <li>
          <a href="/categories/Java/">
            Java (1)
          </a>
        </li>
      
        <li>
          <a href="/categories/Springboot/">
            Springboot (2)
          </a>
        </li>
      
        <li>
          <a href="/categories/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/">
            ç¬¬ä¸€ç¯‡æ–‡ç«  (1)
          </a>
        </li>
      
    
  </ul>

  <!-- æ ‡ç­¾äº‘ -->
  <h3 class="sidebar-title">ğŸ·ï¸ æ ‡ç­¾äº‘</h3>
  <ul class="tag-list">
    
      
        <li>
          <a href="/tags/JUnit/">
            JUnit (1)
          </a>
        </li>
      
        <li>
          <a href="/tags/Java/">
            Java (1)
          </a>
        </li>
      
        <li>
          <a href="/tags/Springboot/">
            Springboot (2)
          </a>
        </li>
      
        <li>
          <a href="/tags/log/">
            log (1)
          </a>
        </li>
      
        <li>
          <a href="/tags/%E5%9F%BA%E7%A1%80/">
            åŸºç¡€ (3)
          </a>
        </li>
      
        <li>
          <a href="/tags/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/">
            ç¬¬ä¸€ç¯‡æ–‡ç«  (1)
          </a>
        </li>
      
    
  </ul>
</aside>

    <!-- å¯¼å…¥ sidebar éƒ¨åˆ†æ¨¡æ¿ -->
  

  <!-- ===== ä¸»ä½“å†…å®¹åŒº ===== -->
  <main id="main-content">
    <section class="main-section">   
  <!-- ============================
       åœ¨çº¿ç¬”è®°ç³»ç»Ÿæ¨¡å—
       åŠŸèƒ½ï¼š
         - åˆ—å‡ºå·²æœ‰æ–‡ç« 
         - æ–°å»ºæ–‡ç« 
         - ç¼–è¾‘æ–‡ç« ï¼ˆæ ‡é¢˜ã€åˆ†ç±»ã€æ ‡ç­¾ã€å†…å®¹ï¼‰
         - å®æ—¶ Markdown é¢„è§ˆ
         - ä¿å­˜åˆ° GitHub ä»“åº“ï¼Œè§¦å‘ Vercel è‡ªåŠ¨éƒ¨ç½²
  ============================ -->
  <h1 style="text-align:center;">ğŸ“’ åœ¨çº¿ç¬”è®°ç³»ç»Ÿ</h1>

  <div style="max-width:1000px; margin:20px auto;">
    <!-- æ–°å»ºæ–‡ç« æŒ‰é’® -->
    <button id="newNoteBtn" style="padding:10px 15px; background:#0078d7; color:#fff; border:none; border-radius:5px; cursor:pointer;">ğŸ“ æ–°å»ºæ–‡ç« </button>

    <!-- æ–‡ç« åˆ—è¡¨å®¹å™¨ -->
    <div id="noteList" style="margin-top:20px;"></div>

    <!-- ç¼–è¾‘å™¨å¼¹çª— -->
    <div id="editorModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
      <div style="background:#fff; width:90%; max-width:800px; margin:50px auto; padding:20px; border-radius:8px; position:relative;">
        <h2 id="editorTitle">ç¼–è¾‘æ–‡ç« </h2>

        <!-- æ ‡é¢˜è¾“å…¥æ¡† -->
        <input type="text" id="noteTitle" placeholder="æ ‡é¢˜" style="width:100%; padding:8px; margin-bottom:10px;">

        <!-- åˆ†ç±»è¾“å…¥æ¡† -->
        <input type="text" id="noteCategory" placeholder="åˆ†ç±»" style="width:100%; padding:8px; margin-bottom:10px;">

        <!-- æ ‡ç­¾è¾“å…¥æ¡† -->
        <input type="text" id="noteTags" placeholder="æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”" style="width:100%; padding:8px; margin-bottom:10px;">

        <!-- å†…å®¹è¾“å…¥æ¡† -->
        <textarea id="noteContent" rows="15" style="width:100%; padding:8px;"></textarea>

        <!-- ä¿å­˜/å–æ¶ˆæŒ‰é’® -->
        <div style="margin-top:10px; display:flex; gap:10px;">
          <button id="saveNoteBtn" style="flex:1; padding:10px; background:#28a745; color:#fff; border:none; border-radius:5px; cursor:pointer;">ğŸ’¾ ä¿å­˜</button>
          <button id="cancelEditBtn" style="flex:1; padding:10px; background:#dc3545; color:#fff; border:none; border-radius:5px; cursor:pointer;">âŒ å–æ¶ˆ</button>
        </div>

        <!-- Markdown å®æ—¶é¢„è§ˆ -->
        <div id="preview" style="margin-top:20px; padding:10px; border:1px solid #ddd; border-radius:5px;"></div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
  const owner = "Sun1105";              // æ›¿æ¢æˆä½ çš„ GitHub ç”¨æˆ·å
  const repo = "hexo-source";           // æ›¿æ¢æˆä½ çš„ä»“åº“å
  const postsDir = "source/_posts";     // Hexo æ–‡ç« ç›®å½•
  let editingNote = null;               // å½“å‰æ­£åœ¨ç¼–è¾‘çš„æ–‡ç« å¯¹è±¡

  const noteListDiv = document.getElementById('noteList');
  const editorModal = document.getElementById('editorModal');
  const noteTitle = document.getElementById('noteTitle');
  const noteCategory = document.getElementById('noteCategory'); // åˆ†ç±»è¾“å…¥æ¡†
  const noteTags = document.getElementById('noteTags');
  const noteContent = document.getElementById('noteContent');
  const saveNoteBtn = document.getElementById('saveNoteBtn');
  const cancelEditBtn = document.getElementById('cancelEditBtn');
  const previewDiv = document.getElementById('preview');

  // ========================
  // 1ï¸âƒ£ åˆ—å‡ºæ–‡ç« åˆ—è¡¨
  // ========================
  async function loadNotes() {
    noteListDiv.innerHTML = "åŠ è½½ä¸­...";
    try {
      const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${postsDir}`);
      const data = await res.json();
      if(res.ok){
        noteListDiv.innerHTML = "";
        data.forEach(file => {
        if(file.name.endsWith(".md")){
          const div = document.createElement('div');
          div.className = "note-item";

          // å·¦ä¾§ï¼šå›¾æ ‡ + æ–‡ä»¶å
          const left = document.createElement('div');
          left.style.display = "flex";
          left.style.alignItems = "center";

          const icon = document.createElement('span');
          icon.className = "note-icon";
          icon.textContent = "ğŸ“„";

          const title = document.createElement('span');
          title.className = "note-title";
          title.textContent = file.name;

          left.appendChild(icon);
          left.appendChild(title);

          // å³ä¾§ï¼šé™„åŠ ä¿¡æ¯ï¼ˆæ¯”å¦‚æ›´æ–°æ—¶é—´ï¼‰
          const meta = document.createElement('span');
          meta.className = "note-meta";
          meta.textContent = new Date(file.git_url ? file.git_url : Date.now()).toLocaleDateString();

          div.appendChild(left);
          div.appendChild(meta);

          div.addEventListener('click', () => openEditor(file));
          noteListDiv.appendChild(div);
        }
        });
      } else {
        noteListDiv.innerHTML = "âŒ è·å–æ–‡ç« åˆ—è¡¨å¤±è´¥ï¼š" + JSON.stringify(data);
      }
    } catch(err){
      noteListDiv.innerHTML = "âŒ ç½‘ç»œé”™è¯¯ï¼š" + err.message;
    }
  }

  // ========================
  // 2ï¸âƒ£ æ‰“å¼€ç¼–è¾‘å™¨
  // ========================
  async function openEditor(file){
    editingNote = file;
    try {
      const res = await fetch(file.download_url);
      const contentText = await res.text();
      const shaRes = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${postsDir}/${file.name}`);
      const shaData = await shaRes.json();
      editingNote.sha = shaData.sha;

      // å¡«å……ç¼–è¾‘å™¨
      noteTitle.value = contentText.match(/title:\s*(.*)/)?.[1] || file.name;
      noteCategory.value = contentText.match(/category:\s*(.*)/)?.[1] || ""; // åˆ†ç±»
      noteTags.value = contentText.match(/tags:\s*\[(.*)\]/)?.[1] || "";
      noteContent.value = contentText.split('---').slice(2).join('---').trim();

      previewDiv.innerHTML = marked.parse(noteContent.value);
      editorModal.style.display = "block";
    } catch(err){
      alert("âŒ æ‰“å¼€ç¼–è¾‘å™¨å¤±è´¥ï¼š" + err.message);
    }
  }

  // ========================
  // 3ï¸âƒ£ æ–°å»ºæ–‡ç« 
  // ========================
  document.getElementById('newNoteBtn').addEventListener('click', () => {
    editingNote = null;
    noteTitle.value = "";
    noteCategory.value = "";
    noteTags.value = "";
    noteContent.value = "";
    previewDiv.innerHTML = "";
    editorModal.style.display = "block";
  });

  // ========================
  // 4ï¸âƒ£ ä¿å­˜æ–‡ç« 
  // ========================
  saveNoteBtn.addEventListener('click', async () => {
    const title = noteTitle.value.trim();
    const category = noteCategory.value.trim(); // åˆ†ç±»
    const tags = noteTags.value.split(',').map(t=>t.trim()).filter(Boolean);
    const content = noteContent.value.trim();

    if(!title || !content){
      alert("æ ‡é¢˜å’Œå†…å®¹ä¸èƒ½ä¸ºç©ºï¼");
      return;
    }

    const mdContent = `---
  title: ${title}
  category: ${category}
  tags: [${tags.join(',')}]
  date: ${new Date().toISOString()}
  ---

  ${content}
  `;

    try {
      let path, sha, message;
      if(editingNote){
        path = `${postsDir}/${editingNote.name}`;
        sha = editingNote.sha;
        message = `ç¼–è¾‘æ–‡ç« : ${title}`;
      } else {
        const fileName = `${Date.now()}-${title.replace(/\s+/g,'-')}.md`;
        path = `${postsDir}/${fileName}`;
        sha = undefined;
        message = `æ–°å»ºæ–‡ç« : ${title}`;
      }

      const res = await fetch(editingNote ? '/api/edit-note' : '/api/new-note', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ path, sha, content: mdContent, message })
      });

      const data = await res.json();
      if(res.ok){
        alert('âœ… ä¿å­˜æˆåŠŸï¼è¯·ç¨ç­‰ Vercel è‡ªåŠ¨éƒ¨ç½²ã€‚');
        editorModal.style.display = "none";
        loadNotes();
      } else {
        alert('âŒ ä¿å­˜å¤±è´¥ï¼š' + JSON.stringify(data.error));
      }
    } catch(err){
      alert("âŒ ç½‘ç»œæˆ–æœåŠ¡å™¨é”™è¯¯ï¼š" + err.message);
    }
  });

  // ========================
  // 5ï¸âƒ£ å–æ¶ˆç¼–è¾‘
  // ========================
  cancelEditBtn.addEventListener('click', () => {
    editorModal.style.display = "none";
  });

  // ========================
  // 6ï¸âƒ£ å®æ—¶ Markdown é¢„è§ˆ
  // ========================
  noteContent.addEventListener('input', () => {
    previewDiv.innerHTML = marked.parse(noteContent.value);
  });

  // ========================
  // 7ï¸âƒ£ åˆå§‹åŒ–åŠ è½½æ–‡ç« åˆ—è¡¨
  // ========================
  loadNotes();
  </script>
  <style>
    /* æ–‡ä»¶åˆ—è¡¨æ•´ä½“å®¹å™¨ */
    #noteList {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* å•ä¸ªæ–‡ç« é¡¹ */
    .note-item {
      padding: 12px 16px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      background: #fafafa;
      transition: all 0.2s ease;
      font-family: "Segoe UI", sans-serif;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    /* é¼ æ ‡æ‚¬åœæ•ˆæœ */
    .note-item:hover {
      background: #f0f8ff;
      border-color: #0078d7;
      transform: translateY(-2px);
      cursor: pointer;
    }

    /* æ–‡ä»¶å */
    .note-title {
      font-weight: 600;
      color: #333;
    }

    /* æ–‡ä»¶å›¾æ ‡ */
    .note-icon {
      margin-right: 8px;
      color: #0078d7;
    }

    /* æ—¶é—´æˆ³æˆ–é™„åŠ ä¿¡æ¯ */
    .note-meta {
      font-size: 12px;
      color: #666;
    }
  </style>
</section>
    <!-- æ¸²æŸ“å½“å‰é¡µé¢å†…å®¹ -->
    <!--  ä¿è¯ HTML æ­£å¸¸æ¸²æŸ“ï¼Œä¸è½¬ä¹‰ -->
  </main>

  <!-- ===== å…¨å±€è„šæœ¬åŒºåŸŸ ===== -->
  <script>
    // ===== é€€å‡ºç™»å½•å‡½æ•° =====
    function logout() {
      localStorage.removeItem("isLoggedIn");
      window.location.href = "/login/";
      // æ¸…é™¤ç™»å½•æ ‡è®°å¹¶è·³è½¬ç™»å½•é¡µ
    }

    // ===== å¹³æ»‘æ»šåŠ¨è‡³é¡¶éƒ¨ =====
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: "smooth" });
      // å¹³æ»‘æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨
    }

    // ===== åˆ‡æ¢å°å±å¹•èœå•å±•å¼€/æ”¶èµ· =====
    function toggleMenu() {
      const menu = document.querySelector('header.top-nav .menu');
      if (menu) {
        menu.classList.toggle('show');
        // åˆ‡æ¢èœå•æ˜¾ç¤ºçŠ¶æ€ï¼Œä¾¿äºç§»åŠ¨ç«¯æ“ä½œ
      }
    }
  </script>

  <!-- ===== å¯é€‰çš„â€œè¿”å›é¡¶éƒ¨â€æŒ‰é’® ===== -->
  <button id="backToTop" title="å›åˆ°é¡¶éƒ¨">â†‘</button>

  <script>
    // ===== è¿”å›é¡¶éƒ¨æŒ‰é’®é€»è¾‘ =====
    const topBtn = document.getElementById('backToTop');
    window.addEventListener('scroll', () => {
      // å½“é¡µé¢å‘ä¸‹æ»šåŠ¨è¶…è¿‡ 300px æ˜¾ç¤ºæŒ‰é’®ï¼Œå¦åˆ™éšè—
      topBtn.style.display = window.scrollY > 300 ? 'block' : 'none';
    });
    topBtn.addEventListener('click', scrollToTop);
    // ç‚¹å‡»æŒ‰é’®è§¦å‘å¹³æ»‘æ»šåŠ¨åˆ°é¡¶éƒ¨
  </script>
</body>
</html>
